{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"/]+|(?!\\b)(?=[A-Z][a-z])|\\.(?!\\d)|&[lg]t;","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"elastic-script","text":"<ul> <li> <p> Procedural Power</p> <p>Write complex logic with variables, loops, conditionals, and error handling - all inside Elasticsearch.</p> <p> Getting Started</p> </li> <li> <p> Native ES|QL Integration</p> <p>Query your data with ES|QL and process results with cursors and loops.</p> <p> Elasticsearch Functions</p> </li> <li> <p> AI &amp; LLM Built-in</p> <p>Summarize logs, classify events, and generate insights with OpenAI or Elasticsearch Inference.</p> <p> AI Functions</p> </li> <li> <p> Async Execution</p> <p>Chain procedures with <code>ON_DONE</code>, <code>ON_FAIL</code>, and run tasks in parallel.</p> <p> Async Guide</p> </li> </ul>"},{"location":"#what-is-elastic-script","title":"What is elastic-script?","text":"<p>elastic-script is a procedural scripting language that runs inside Elasticsearch. It's designed for:</p> <ul> <li>Runbook Automation - Codify operational procedures that respond to alerts</li> <li>Data Processing - Transform and enrich data with complex logic</li> <li>AI/ML Integration - Leverage LLMs for log analysis and anomaly detection</li> <li>Cross-System Orchestration - Connect to Slack, PagerDuty, AWS, Kubernetes, and more</li> </ul>"},{"location":"#quick-example","title":"Quick Example","text":"<pre><code>CREATE PROCEDURE analyze_errors()\nBEGIN\n    -- Query recent errors\n    DECLARE errors CURSOR FOR\n        FROM logs-*\n        | WHERE level == \"ERROR\"\n        | WHERE @timestamp &gt; NOW() - 1 HOUR\n        | LIMIT 100;\n\n    -- Count and summarize\n    DECLARE error_count NUMBER = 0;\n    DECLARE messages STRING = '';\n\n    FOR error IN errors LOOP\n        SET error_count = error_count + 1;\n        SET messages = messages || error.message || '\\n';\n    END LOOP;\n\n    -- Use AI to summarize if many errors\n    IF error_count &gt; 10 THEN\n        DECLARE summary STRING = LLM_SUMMARIZE(messages);\n        PRINT 'Error Summary: ' || summary;\n    END IF;\n\n    RETURN error_count;\nEND PROCEDURE;\n</code></pre>"},{"location":"#key-features","title":"Key Features","text":""},{"location":"#106-built-in-functions","title":"\ud83d\udd27 106 Built-in Functions","text":"Category Functions String <code>LENGTH</code>, <code>SUBSTR</code>, <code>UPPER</code>, <code>LOWER</code>, <code>TRIM</code>, <code>REPLACE</code>, <code>REGEXP_REPLACE</code>... Array <code>ARRAY_LENGTH</code>, <code>ARRAY_APPEND</code>, <code>ARRAY_FILTER</code>, <code>ARRAY_MAP</code>, <code>ARRAY_REDUCE</code>... Elasticsearch <code>ESQL_QUERY</code>, <code>INDEX_DOCUMENT</code>, <code>GET_DOCUMENT</code>, <code>REFRESH_INDEX</code>... AI/LLM <code>LLM_COMPLETE</code>, <code>LLM_SUMMARIZE</code>, <code>LLM_CLASSIFY</code>, <code>INFERENCE</code>... Integrations <code>SLACK_SEND</code>, <code>PAGERDUTY_TRIGGER</code>, <code>K8S_SCALE</code>, <code>AWS_LAMBDA_INVOKE</code>..."},{"location":"#async-execution","title":"\u26a1 Async Execution","text":"<pre><code>-- Chain procedures with continuations\nanalyze_logs()\n    | ON_DONE notify_team(@result)\n    | ON_FAIL alert_oncall(@error)\n    | TRACK AS 'daily-analysis';\n\n-- Run in parallel\nPARALLEL [fetch_logs(), fetch_metrics()]\n    | ON_ALL_DONE merge_results(@results);\n</code></pre>"},{"location":"#full-observability","title":"\ud83d\udd0d Full Observability","text":"<ul> <li>Structured logging with execution IDs</li> <li>Elastic APM tracing (optional)</li> <li>Execution state persisted in <code>.escript_executions</code></li> </ul>"},{"location":"#installation","title":"Installation","text":"Quick StartManual Setup <pre><code>git clone https://github.com/bahaaldine/elastic-script.git\ncd elastic-script\n./scripts/quick-start.sh\n</code></pre> <pre><code># Build the plugin\ncd elasticsearch\n./gradlew :x-pack:plugin:elastic-script:assemble\n\n# Install in your ES cluster\nbin/elasticsearch-plugin install file:///path/to/elastic-script.zip\n</code></pre>"},{"location":"#try-it-now","title":"Try It Now","text":"<p>Once running, create and call procedures:</p> <pre><code># Create a procedure\ncurl -u elastic-admin:elastic-password http://localhost:9200/_escript \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"CREATE PROCEDURE hello() BEGIN RETURN '\\''Hello, World!'\\''; END PROCEDURE;\"}'\n\n# Call it\ncurl -u elastic-admin:elastic-password http://localhost:9200/_escript \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"CALL hello()\"}'\n\n# Response: {\"result\": \"Hello, World!\"}\n</code></pre> <p>Or use the Jupyter notebook interface for interactive development!</p> <ul> <li> <p> Read the Docs</p> <p> Language Guide</p> </li> <li> <p> Function Reference</p> <p> All 106 Functions</p> </li> <li> <p> Examples</p> <p> Real-world Use Cases</p> </li> </ul>"},{"location":"development/architecture/","title":"Development","text":"<p>Coming Soon</p> <p>Developer documentation is being written.</p> <p>See <code>CLAUDE.md</code> for current development status.</p>"},{"location":"development/contributing/","title":"Development","text":"<p>Coming Soon</p> <p>Developer documentation is being written.</p> <p>See <code>CLAUDE.md</code> for current development status.</p>"},{"location":"development/testing/","title":"Development","text":"<p>Coming Soon</p> <p>Developer documentation is being written.</p> <p>See <code>CLAUDE.md</code> for current development status.</p>"},{"location":"examples/data-pipeline/","title":"Examples","text":"<p>Coming Soon</p> <p>Real-world examples are being developed.</p> <p>Check the notebooks in <code>notebooks/</code> for working examples.</p>"},{"location":"examples/incident-response/","title":"Examples","text":"<p>Coming Soon</p> <p>Real-world examples are being developed.</p> <p>Check the notebooks in <code>notebooks/</code> for working examples.</p>"},{"location":"examples/log-analysis/","title":"Examples","text":"<p>Coming Soon</p> <p>Real-world examples are being developed.</p> <p>Check the notebooks in <code>notebooks/</code> for working examples.</p>"},{"location":"functions/ai-llm/","title":"Functions","text":"<p>Coming Soon</p> <p>Detailed documentation for these functions is being written.</p> <p>In the meantime, use <code>ESCRIPT_FUNCTIONS()</code> to discover available functions.</p> <pre><code>DECLARE functions ARRAY = ESCRIPT_FUNCTIONS();\nFOR func IN functions LOOP\n    PRINT func.name || ': ' || func.description;\nEND LOOP;\n</code></pre>"},{"location":"functions/array/","title":"Functions","text":"<p>Coming Soon</p> <p>Detailed documentation for these functions is being written.</p> <p>In the meantime, use <code>ESCRIPT_FUNCTIONS()</code> to discover available functions.</p> <pre><code>DECLARE functions ARRAY = ESCRIPT_FUNCTIONS();\nFOR func IN functions LOOP\n    PRINT func.name || ': ' || func.description;\nEND LOOP;\n</code></pre>"},{"location":"functions/date/","title":"Functions","text":"<p>Coming Soon</p> <p>Detailed documentation for these functions is being written.</p> <p>In the meantime, use <code>ESCRIPT_FUNCTIONS()</code> to discover available functions.</p> <pre><code>DECLARE functions ARRAY = ESCRIPT_FUNCTIONS();\nFOR func IN functions LOOP\n    PRINT func.name || ': ' || func.description;\nEND LOOP;\n</code></pre>"},{"location":"functions/document/","title":"Functions","text":"<p>Coming Soon</p> <p>Detailed documentation for these functions is being written.</p> <p>In the meantime, use <code>ESCRIPT_FUNCTIONS()</code> to discover available functions.</p> <pre><code>DECLARE functions ARRAY = ESCRIPT_FUNCTIONS();\nFOR func IN functions LOOP\n    PRINT func.name || ': ' || func.description;\nEND LOOP;\n</code></pre>"},{"location":"functions/elasticsearch/","title":"Functions","text":"<p>Coming Soon</p> <p>Detailed documentation for these functions is being written.</p> <p>In the meantime, use <code>ESCRIPT_FUNCTIONS()</code> to discover available functions.</p> <pre><code>DECLARE functions ARRAY = ESCRIPT_FUNCTIONS();\nFOR func IN functions LOOP\n    PRINT func.name || ': ' || func.description;\nEND LOOP;\n</code></pre>"},{"location":"functions/integrations/","title":"Functions","text":"<p>Coming Soon</p> <p>Detailed documentation for these functions is being written.</p> <p>In the meantime, use <code>ESCRIPT_FUNCTIONS()</code> to discover available functions.</p> <pre><code>DECLARE functions ARRAY = ESCRIPT_FUNCTIONS();\nFOR func IN functions LOOP\n    PRINT func.name || ': ' || func.description;\nEND LOOP;\n</code></pre>"},{"location":"functions/number/","title":"Functions","text":"<p>Coming Soon</p> <p>Detailed documentation for these functions is being written.</p> <p>In the meantime, use <code>ESCRIPT_FUNCTIONS()</code> to discover available functions.</p> <pre><code>DECLARE functions ARRAY = ESCRIPT_FUNCTIONS();\nFOR func IN functions LOOP\n    PRINT func.name || ': ' || func.description;\nEND LOOP;\n</code></pre>"},{"location":"functions/overview/","title":"Functions Overview","text":"<p>elastic-script includes 106 built-in functions across 12 categories.</p>"},{"location":"functions/overview/#function-categories","title":"Function Categories","text":"Category Count Description String 18 Text manipulation Number 11 Mathematical operations Array 18 List operations Date 8 Date/time handling Document 6 JSON object manipulation Elasticsearch 5 ES operations AI &amp; LLM 14 AI/ML functions Integrations 26 External services"},{"location":"functions/overview/#quick-reference","title":"Quick Reference","text":""},{"location":"functions/overview/#string-functions","title":"String Functions","text":"<pre><code>LENGTH(str)              -- String length\nSUBSTR(str, start, len)  -- Substring\nUPPER(str)               -- Uppercase\nLOWER(str)               -- Lowercase\nTRIM(str)                -- Remove whitespace\nREPLACE(str, old, new)   -- Replace text\nCONCAT(str1, str2, ...)  -- Concatenate\nSPLIT(str, delimiter)    -- Split to array\n</code></pre>"},{"location":"functions/overview/#array-functions","title":"Array Functions","text":"<pre><code>ARRAY_LENGTH(arr)        -- Array size\nARRAY_APPEND(arr, val)   -- Add element\nARRAY_CONTAINS(arr, val) -- Check membership\nARRAY_FILTER(arr, fn)    -- Filter elements\nARRAY_MAP(arr, fn)       -- Transform elements\nARRAY_JOIN(arr, sep)     -- Join to string\n</code></pre>"},{"location":"functions/overview/#elasticsearch-functions","title":"Elasticsearch Functions","text":"<pre><code>ESQL_QUERY(query)        -- Execute ES|QL\nINDEX_DOCUMENT(idx, doc) -- Index document\nGET_DOCUMENT(idx, id)    -- Get by ID\nREFRESH_INDEX(idx)       -- Refresh index\n</code></pre>"},{"location":"functions/overview/#aillm-functions","title":"AI/LLM Functions","text":"<pre><code>LLM_COMPLETE(prompt)     -- Generate text\nLLM_SUMMARIZE(text)      -- Summarize text\nLLM_CLASSIFY(text, labels) -- Classify text\nINFERENCE(endpoint, input) -- ES Inference API\n</code></pre>"},{"location":"functions/overview/#integration-functions","title":"Integration Functions","text":"<pre><code>SLACK_SEND(channel, msg) -- Send to Slack\nPAGERDUTY_TRIGGER(...)   -- Create incident\nK8S_SCALE(ns, deploy, n) -- Scale deployment\nAWS_LAMBDA_INVOKE(...)   -- Invoke Lambda\n</code></pre>"},{"location":"functions/overview/#calling-functions","title":"Calling Functions","text":"<p>Functions are called like in SQL:</p> <pre><code>DECLARE len NUMBER = LENGTH('Hello');\nDECLARE upper STRING = UPPER(name);\nDECLARE logs ARRAY = ESQL_QUERY('FROM logs | LIMIT 10');\n</code></pre>"},{"location":"functions/overview/#chaining-functions","title":"Chaining Functions","text":"<pre><code>DECLARE result = UPPER(TRIM(SUBSTR(text, 1, 10)));\n</code></pre>"},{"location":"functions/overview/#function-discovery","title":"Function Discovery","text":"<p>List all available functions:</p> <pre><code>DECLARE functions ARRAY = ESCRIPT_FUNCTIONS();\n\nFOR func IN functions LOOP\n    PRINT func.name || ': ' || func.description;\nEND LOOP;\n</code></pre> <p>Get details for a specific function:</p> <pre><code>DECLARE info DOCUMENT = ESCRIPT_FUNCTION('ARRAY_MAP');\nPRINT info.signature;\nPRINT info.description;\nPRINT info.examples;\n</code></pre>"},{"location":"functions/overview/#next-steps","title":"Next Steps","text":"<p>Explore each category:</p> <ul> <li>String Functions - Text manipulation</li> <li>Array Functions - List operations</li> <li>Elasticsearch Functions - ES integration</li> <li>AI &amp; LLM Functions - AI capabilities</li> </ul>"},{"location":"functions/string/","title":"Functions","text":"<p>Coming Soon</p> <p>Detailed documentation for these functions is being written.</p> <p>In the meantime, use <code>ESCRIPT_FUNCTIONS()</code> to discover available functions.</p> <pre><code>DECLARE functions ARRAY = ESCRIPT_FUNCTIONS();\nFOR func IN functions LOOP\n    PRINT func.name || ': ' || func.description;\nEND LOOP;\n</code></pre>"},{"location":"getting-started/installation/","title":"Installation","text":""},{"location":"getting-started/installation/#prerequisites","title":"Prerequisites","text":"<p>Before installing elastic-script, ensure you have:</p> <ul> <li>Java 21+ - Required for Elasticsearch 9.x</li> <li>Git - For cloning the repository</li> <li>8GB+ RAM - Elasticsearch needs memory</li> </ul> <p>Optional for development: - Python 3.9+ - For Jupyter notebooks - OpenAI API Key - For AI/LLM features</p>"},{"location":"getting-started/installation/#quick-start-recommended","title":"Quick Start (Recommended)","text":"<p>The fastest way to get started:</p> <pre><code># Clone the repository\ngit clone https://github.com/bahaaldine/elastic-script.git\ncd elastic-script\n\n# Run the quick-start script\n./scripts/quick-start.sh\n</code></pre> <p>This will:</p> <ol> <li>\u2705 Check prerequisites</li> <li>\u2705 Build the elastic-script plugin</li> <li>\u2705 Start Elasticsearch with the plugin</li> <li>\u2705 Load sample data (360 documents across 6 indices)</li> <li>\u2705 Set up Jupyter notebooks</li> <li>\u2705 Print curl examples</li> </ol> <p>OpenAI API Key</p> <p>The script will prompt for your OpenAI API key (optional). This enables AI functions like <code>LLM_COMPLETE()</code> and <code>LLM_SUMMARIZE()</code>.</p>"},{"location":"getting-started/installation/#manual-installation","title":"Manual Installation","text":""},{"location":"getting-started/installation/#1-clone-the-repository","title":"1. Clone the Repository","text":"<pre><code>git clone https://github.com/bahaaldine/elastic-script.git\ncd elastic-script\n\n# Initialize the Elasticsearch submodule\ngit submodule init\ngit submodule update\n</code></pre>"},{"location":"getting-started/installation/#2-build-the-plugin","title":"2. Build the Plugin","text":"<pre><code>cd elasticsearch\n./gradlew :x-pack:plugin:elastic-script:assemble\n</code></pre> <p>The plugin ZIP will be at: <pre><code>x-pack/plugin/elastic-script/build/distributions/elastic-script-*.zip\n</code></pre></p>"},{"location":"getting-started/installation/#3-start-elasticsearch","title":"3. Start Elasticsearch","text":"<p>For development:</p> <pre><code>./gradlew :run\n</code></pre> <p>For production, install the plugin:</p> <pre><code>bin/elasticsearch-plugin install file:///path/to/elastic-script-9.4.0-SNAPSHOT.zip\nbin/elasticsearch\n</code></pre>"},{"location":"getting-started/installation/#verify-installation","title":"Verify Installation","text":"<p>Check that elastic-script is working:</p> <pre><code># Health check\ncurl -u elastic-admin:elastic-password http://localhost:9200/_escript \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"CREATE PROCEDURE test() BEGIN RETURN 42; END PROCEDURE;\"}'\n\n# Expected: {\"result\":{\"id\":\"test\",\"index\":\".elastic_script_procedures\",\"result\":\"created\"}}\n\ncurl -u elastic-admin:elastic-password http://localhost:9200/_escript \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"CALL test()\"}'\n\n# Expected: {\"result\": 42}\n</code></pre>"},{"location":"getting-started/installation/#default-credentials","title":"Default Credentials","text":"<p>When using <code>./gradlew :run</code> (development mode):</p> Setting Value URL <code>http://localhost:9200</code> Username <code>elastic-admin</code> Password <code>elastic-password</code>"},{"location":"getting-started/installation/#sample-data","title":"Sample Data","text":"<p>The quick-start script loads sample data into these indices:</p> Index Documents Description <code>logs-sample</code> 100 Application logs with ERROR, WARN, INFO levels <code>metrics-sample</code> 80 System metrics (CPU, memory, latency) <code>users-sample</code> 30 User profiles with roles <code>orders-sample</code> 50 E-commerce orders <code>products-sample</code> 40 Product catalog <code>security-events</code> 60 Audit events"},{"location":"getting-started/installation/#stopping-services","title":"Stopping Services","text":"<pre><code># Stop everything\n./scripts/quick-start.sh --stop\n\n# Stop only Jupyter\n./scripts/quick-start.sh --stop-notebooks\n\n# Stop only Kibana (if running)\n./scripts/quick-start.sh --stop-kibana\n</code></pre>"},{"location":"getting-started/installation/#check-status","title":"Check Status","text":"<pre><code>./scripts/quick-start.sh --status\n</code></pre>"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start Guide - Your first procedure</li> <li>Jupyter Setup - Interactive development</li> <li>Language Overview - Learn the syntax</li> </ul>"},{"location":"getting-started/jupyter-setup/","title":"Jupyter Notebook Setup","text":"<p>elastic-script includes a custom Jupyter kernel for interactive development.</p>"},{"location":"getting-started/jupyter-setup/#quick-setup","title":"Quick Setup","text":"<p>If you used <code>quick-start.sh</code>, Jupyter is already configured. Access it at:</p> <pre><code>http://localhost:8888\n</code></pre>"},{"location":"getting-started/jupyter-setup/#manual-setup","title":"Manual Setup","text":""},{"location":"getting-started/jupyter-setup/#1-install-python-dependencies","title":"1. Install Python Dependencies","text":"<pre><code>cd notebooks\npip install -r requirements.txt\n</code></pre>"},{"location":"getting-started/jupyter-setup/#2-install-the-kernel","title":"2. Install the Kernel","text":"<pre><code>cd kernel\n./install.sh\n</code></pre> <p>This installs <code>plesql_kernel</code> as a Jupyter kernel.</p>"},{"location":"getting-started/jupyter-setup/#3-start-jupyter","title":"3. Start Jupyter","text":"<pre><code>jupyter notebook\n</code></pre> <p>Or via quick-start: <pre><code>./scripts/quick-start.sh --notebooks\n</code></pre></p>"},{"location":"getting-started/jupyter-setup/#using-the-kernel","title":"Using the Kernel","text":""},{"location":"getting-started/jupyter-setup/#create-a-new-notebook","title":"Create a New Notebook","text":"<ol> <li>Open Jupyter at <code>http://localhost:8888</code></li> <li>Click \"New\" \u2192 \"plesql_kernel\"</li> <li>Start writing procedures!</li> </ol>"},{"location":"getting-started/jupyter-setup/#example-cells","title":"Example Cells","text":"<p>Cell 1: Create a procedure <pre><code>CREATE PROCEDURE hello()\nBEGIN\n    RETURN 'Hello from Jupyter!';\nEND PROCEDURE\n</code></pre></p> <p>Cell 2: Call it <pre><code>CALL hello()\n</code></pre></p> <p>Output: <pre><code>Hello from Jupyter!\n</code></pre></p>"},{"location":"getting-started/jupyter-setup/#available-notebooks","title":"Available Notebooks","text":"<p>The <code>notebooks/</code> directory includes example notebooks:</p> Notebook Description <code>01-getting-started.ipynb</code> Basic language features <code>02-esql-integration.ipynb</code> ES <code>03-ai-observability.ipynb</code> LLM functions <code>04-async-execution.ipynb</code> ON_DONE, PARALLEL <code>05-runbook-integrations.ipynb</code> Slack, K8s, PagerDuty <code>00-complete-reference.ipynb</code> All functions showcase"},{"location":"getting-started/jupyter-setup/#kernel-configuration","title":"Kernel Configuration","text":"<p>The kernel connects to Elasticsearch at:</p> <pre><code># notebooks/kernel/plesql_kernel.py\nself.es_endpoint = \"http://localhost:9200/_escript\"\nself.es_auth = (\"elastic-admin\", \"elastic-password\")\n</code></pre> <p>To change credentials, edit the kernel file.</p>"},{"location":"getting-started/jupyter-setup/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/jupyter-setup/#kernel-not-found","title":"Kernel Not Found","text":"<pre><code># Reinstall the kernel\ncd notebooks/kernel\n./install.sh\n\n# Verify installation\njupyter kernelspec list\n</code></pre>"},{"location":"getting-started/jupyter-setup/#connection-refused","title":"Connection Refused","text":"<p>Ensure Elasticsearch is running: <pre><code>curl -u elastic-admin:elastic-password http://localhost:9200\n</code></pre></p>"},{"location":"getting-started/jupyter-setup/#syntax-errors","title":"Syntax Errors","text":"<p>The kernel expects elastic-script syntax, not Python:</p> <pre><code>-- \u2705 Correct\nCREATE PROCEDURE test() BEGIN RETURN 42; END PROCEDURE;\n\n-- \u274c Wrong (Python syntax)\ndef test():\n    return 42\n</code></pre>"},{"location":"getting-started/jupyter-setup/#tips","title":"Tips","text":""},{"location":"getting-started/jupyter-setup/#use-print-for-debugging","title":"Use PRINT for Debugging","text":"<pre><code>CREATE PROCEDURE debug_demo()\nBEGIN\n    DECLARE x NUMBER = 10;\n    PRINT 'Value of x: ' || x;\n\n    SET x = x * 2;\n    PRINT 'After doubling: ' || x;\n\n    RETURN x;\nEND PROCEDURE;\n</code></pre>"},{"location":"getting-started/jupyter-setup/#comments","title":"Comments","text":"<pre><code>-- Single line comment\n\n/*\n * Multi-line\n * comment\n */\n</code></pre>"},{"location":"getting-started/jupyter-setup/#view-all-procedures","title":"View All Procedures","text":"<pre><code>-- List stored procedures\nCALL ESCRIPT_PROCEDURES()\n</code></pre>"},{"location":"getting-started/quick-start/","title":"Quick Start","text":"<p>This guide will have you running elastic-script procedures in 5 minutes.</p>"},{"location":"getting-started/quick-start/#hello-world","title":"Hello World","text":"<p>Create your first procedure:</p> <pre><code>curl -u elastic-admin:elastic-password http://localhost:9200/_escript \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"query\": \"CREATE PROCEDURE hello_world() BEGIN RETURN '\\''Hello, World!'\\''; END PROCEDURE;\"\n  }'\n</code></pre> <p>Call it:</p> <pre><code>curl -u elastic-admin:elastic-password http://localhost:9200/_escript \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"CALL hello_world()\"}'\n</code></pre> <p>Response: <pre><code>{\"result\": \"Hello, World!\"}\n</code></pre></p>"},{"location":"getting-started/quick-start/#with-parameters","title":"With Parameters","text":"<pre><code>CREATE PROCEDURE greet(name STRING)\nBEGIN\n    RETURN 'Hello, ' || name || '!';\nEND PROCEDURE;\n</code></pre> <pre><code>curl -u elastic-admin:elastic-password http://localhost:9200/_escript \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"CALL greet('\\''Alice'\\'')\"}'\n</code></pre> <p>Response: <pre><code>{\"result\": \"Hello, Alice!\"}\n</code></pre></p>"},{"location":"getting-started/quick-start/#variables-and-types","title":"Variables and Types","text":"<pre><code>CREATE PROCEDURE demo_types()\nBEGIN\n    -- String\n    DECLARE message STRING = 'Hello';\n\n    -- Number\n    DECLARE count NUMBER = 42;\n\n    -- Boolean\n    DECLARE is_active BOOLEAN = TRUE;\n\n    -- Array\n    DECLARE items ARRAY = ['apple', 'banana', 'cherry'];\n\n    -- Document (JSON object)\n    DECLARE user DOCUMENT = {\"name\": \"John\", \"age\": 30};\n\n    PRINT 'Message: ' || message;\n    PRINT 'Count: ' || count;\n    PRINT 'Active: ' || is_active;\n    PRINT 'First item: ' || items[0];\n    PRINT 'User name: ' || user.name;\n\n    RETURN 'Demo complete!';\nEND PROCEDURE;\n</code></pre>"},{"location":"getting-started/quick-start/#control-flow","title":"Control Flow","text":""},{"location":"getting-started/quick-start/#ifthenelse","title":"IF/THEN/ELSE","text":"<pre><code>CREATE PROCEDURE check_severity(error_count NUMBER)\nBEGIN\n    DECLARE status STRING;\n\n    IF error_count == 0 THEN\n        SET status = 'Healthy';\n    ELSEIF error_count &lt; 10 THEN\n        SET status = 'Warning';\n    ELSE\n        SET status = 'Critical';\n    END IF;\n\n    RETURN status;\nEND PROCEDURE;\n</code></pre>"},{"location":"getting-started/quick-start/#for-loop","title":"FOR Loop","text":"<pre><code>CREATE PROCEDURE count_to(n NUMBER)\nBEGIN\n    FOR i IN 1..n LOOP\n        PRINT 'Count: ' || i;\n    END LOOP;\n\n    RETURN 'Done!';\nEND PROCEDURE;\n</code></pre>"},{"location":"getting-started/quick-start/#array-iteration","title":"Array Iteration","text":"<pre><code>CREATE PROCEDURE process_items()\nBEGIN\n    DECLARE fruits ARRAY = ['apple', 'banana', 'cherry'];\n\n    FOR fruit IN fruits LOOP\n        PRINT 'Processing: ' || fruit;\n    END LOOP;\n\n    RETURN ARRAY_LENGTH(fruits) || ' items processed';\nEND PROCEDURE;\n</code></pre>"},{"location":"getting-started/quick-start/#query-elasticsearch","title":"Query Elasticsearch","text":"<pre><code>CREATE PROCEDURE get_recent_logs()\nBEGIN\n    -- Execute ES|QL query\n    DECLARE logs ARRAY = ESQL_QUERY('FROM logs-sample | LIMIT 10');\n\n    PRINT 'Found ' || ARRAY_LENGTH(logs) || ' logs';\n\n    RETURN logs;\nEND PROCEDURE;\n</code></pre>"},{"location":"getting-started/quick-start/#error-handling","title":"Error Handling","text":"<pre><code>CREATE PROCEDURE safe_divide(a NUMBER, b NUMBER)\nBEGIN\n    TRY\n        IF b == 0 THEN\n            THROW 'Division by zero!';\n        END IF;\n        RETURN a / b;\n    CATCH\n        RETURN 'Error: Cannot divide by zero';\n    END TRY;\nEND PROCEDURE;\n</code></pre>"},{"location":"getting-started/quick-start/#next-steps","title":"Next Steps","text":"<ul> <li>Jupyter Setup - Interactive development</li> <li>Language Overview - Full syntax guide</li> <li>Function Reference - All 106 functions</li> </ul>"},{"location":"language/async-execution/","title":"Async Execution","text":"<p>elastic-script supports pipe-driven asynchronous execution, allowing you to chain procedures with continuations and run tasks in parallel.</p>"},{"location":"language/async-execution/#on_done-on_fail","title":"ON_DONE / ON_FAIL","text":"<p>Chain procedures with success and failure handlers:</p> <pre><code>CREATE PROCEDURE run_analysis()\nBEGIN\n    analyze_logs()\n        | ON_DONE handle_success(@result)\n        | ON_FAIL handle_error(@error);\n\n    RETURN 'Analysis started';\nEND PROCEDURE;\n</code></pre>"},{"location":"language/async-execution/#how-it-works","title":"How It Works","text":"<ol> <li><code>analyze_logs()</code> executes asynchronously</li> <li>On success: <code>handle_success()</code> is called with <code>@result</code></li> <li>On failure: <code>handle_error()</code> is called with <code>@error</code></li> <li>The calling procedure returns immediately</li> </ol>"},{"location":"language/async-execution/#bindings","title":"Bindings","text":"Binding Description Available In <code>@result</code> Return value of previous procedure <code>ON_DONE</code> <code>@error</code> Error message from failed procedure <code>ON_FAIL</code> <code>@results</code> Array of results from parallel execution <code>ON_ALL_DONE</code>"},{"location":"language/async-execution/#parallel-execution","title":"PARALLEL Execution","text":"<p>Run multiple procedures concurrently:</p> <pre><code>CREATE PROCEDURE fetch_all_data()\nBEGIN\n    PARALLEL [fetch_logs(), fetch_metrics(), fetch_events()]\n        | ON_ALL_DONE merge_results(@results);\n\n    RETURN 'Parallel fetch started';\nEND PROCEDURE;\n\nCREATE PROCEDURE merge_results(results ARRAY)\nBEGIN\n    PRINT 'Received ' || ARRAY_LENGTH(results) || ' results';\n    -- Process merged results\n    RETURN results;\nEND PROCEDURE;\n</code></pre>"},{"location":"language/async-execution/#parallel-continuations","title":"Parallel Continuations","text":"Continuation Triggered When <code>ON_ALL_DONE</code> All procedures complete successfully <code>ON_ANY_FAIL</code> Any procedure fails"},{"location":"language/async-execution/#track-as","title":"TRACK AS","text":"<p>Track execution state for later querying:</p> <pre><code>analyze_logs()\n    | ON_DONE handle_success(@result)\n    | TRACK AS 'daily-analysis';\n</code></pre> <p>Execution state is stored in <code>.escript_executions</code> index.</p>"},{"location":"language/async-execution/#execution-control","title":"EXECUTION Control","text":"<p>Query and control tracked executions:</p> <pre><code>-- Check status\nEXECUTION('daily-analysis') | STATUS;\n\n-- Cancel execution\nEXECUTION('daily-analysis') | CANCEL;\n\n-- Retry failed execution\nEXECUTION('daily-analysis') | RETRY;\n\n-- Wait for completion\nEXECUTION('daily-analysis') | WAIT;\n</code></pre>"},{"location":"language/async-execution/#finally","title":"FINALLY","text":"<p>Execute cleanup code regardless of success/failure:</p> <pre><code>process_data()\n    | ON_DONE save_results(@result)\n    | ON_FAIL log_error(@error)\n    | FINALLY cleanup();\n</code></pre>"},{"location":"language/async-execution/#complete-example","title":"Complete Example","text":"<pre><code>-- Main analysis procedure\nCREATE PROCEDURE analyze_logs(index_pattern STRING)\nBEGIN\n    PRINT 'Analyzing logs from: ' || index_pattern;\n\n    DECLARE errors CURSOR FOR\n        FROM logs-*\n        | WHERE level == \"ERROR\"\n        | WHERE @timestamp &gt; NOW() - 1 HOUR\n        | LIMIT 100;\n\n    DECLARE count NUMBER = 0;\n    FOR error IN errors LOOP\n        SET count = count + 1;\n    END LOOP;\n\n    RETURN { \"error_count\": count, \"index\": index_pattern };\nEND PROCEDURE;\n\n-- Success handler\nCREATE PROCEDURE handle_success(result DOCUMENT)\nBEGIN\n    PRINT 'Analysis complete: ' || result;\n\n    IF result.error_count &gt; 50 THEN\n        -- Trigger alert\n        SLACK_SEND('#alerts', 'High error count: ' || result.error_count);\n    END IF;\n\n    RETURN 'handled';\nEND PROCEDURE;\n\n-- Error handler\nCREATE PROCEDURE handle_error(error STRING)\nBEGIN\n    PRINT 'Analysis failed: ' || error;\n    PAGERDUTY_TRIGGER('Analysis pipeline failed', error);\n    RETURN 'error_handled';\nEND PROCEDURE;\n\n-- Run the pipeline\nCREATE PROCEDURE run_daily_analysis()\nBEGIN\n    analyze_logs('logs-*')\n        | ON_DONE handle_success(@result)\n        | ON_FAIL handle_error(@error)\n        | TRACK AS 'daily-analysis';\n\n    RETURN 'Analysis pipeline started';\nEND PROCEDURE;\n</code></pre>"},{"location":"language/async-execution/#execution-state","title":"Execution State","text":"<p>Tracked executions are stored in <code>.escript_executions</code>:</p> <pre><code>{\n  \"execution_id\": \"exec-abc123\",\n  \"track_name\": \"daily-analysis\",\n  \"status\": \"COMPLETED\",\n  \"procedure_name\": \"analyze_logs\",\n  \"result\": { \"error_count\": 42, \"index\": \"logs-*\" },\n  \"started_at\": \"2026-01-09T10:00:00Z\",\n  \"completed_at\": \"2026-01-09T10:00:05Z\",\n  \"duration_ms\": 5000\n}\n</code></pre>"},{"location":"language/async-execution/#best-practices","title":"Best Practices","text":"<p>Keep handlers simple</p> <p>Continuation handlers should be lightweight. Heavy processing should happen in the main procedure.</p> <p>Use TRACK for important workflows</p> <p>Track executions that you need to monitor or retry.</p> <p>Async is inside procedures only</p> <p>Async syntax (<code>|</code>) is only valid inside procedures, not as top-level API calls.</p>"},{"location":"language/control-flow/","title":"Control Flow","text":""},{"location":"language/control-flow/#if-then-else","title":"IF / THEN / ELSE","text":"<p>Conditional execution:</p> <pre><code>IF condition THEN\n    -- statements\nEND IF;\n</code></pre> <p>With ELSE:</p> <pre><code>IF error_count == 0 THEN\n    SET status = 'Healthy';\nELSE\n    SET status = 'Has errors';\nEND IF;\n</code></pre> <p>With ELSEIF:</p> <pre><code>IF error_count == 0 THEN\n    SET status = 'Healthy';\nELSEIF error_count &lt; 10 THEN\n    SET status = 'Warning';\nELSEIF error_count &lt; 100 THEN\n    SET status = 'Critical';\nELSE\n    SET status = 'Emergency';\nEND IF;\n</code></pre>"},{"location":"language/control-flow/#for-loop","title":"FOR Loop","text":""},{"location":"language/control-flow/#range-based","title":"Range-based","text":"<p>Iterate over a numeric range:</p> <pre><code>FOR i IN 1..10 LOOP\n    PRINT 'Count: ' || i;\nEND LOOP;\n</code></pre>"},{"location":"language/control-flow/#array-iteration","title":"Array iteration","text":"<p>Iterate over array elements:</p> <pre><code>DECLARE fruits ARRAY = ['apple', 'banana', 'cherry'];\n\nFOR fruit IN fruits LOOP\n    PRINT 'Processing: ' || fruit;\nEND LOOP;\n</code></pre>"},{"location":"language/control-flow/#cursor-iteration","title":"CURSOR iteration","text":"<p>Iterate over query results:</p> <pre><code>DECLARE logs CURSOR FOR\n    FROM logs-sample\n    | WHERE level == \"ERROR\"\n    | LIMIT 100;\n\nFOR log IN logs LOOP\n    PRINT log.message;\nEND LOOP;\n</code></pre>"},{"location":"language/control-flow/#while-loop","title":"WHILE Loop","text":"<p>Repeat while condition is true:</p> <pre><code>DECLARE i NUMBER = 0;\n\nWHILE i &lt; 10 LOOP\n    PRINT 'i = ' || i;\n    SET i = i + 1;\nEND LOOP;\n</code></pre> <p>Avoid infinite loops</p> <p>Always ensure the condition will eventually become false.</p>"},{"location":"language/control-flow/#loop-with-exit","title":"LOOP with EXIT","text":"<p>Manual loop control:</p> <pre><code>DECLARE i NUMBER = 0;\n\nLOOP\n    SET i = i + 1;\n\n    IF i &gt; 10 THEN\n        EXIT;  -- Break out of loop\n    END IF;\n\n    PRINT 'i = ' || i;\nEND LOOP;\n</code></pre>"},{"location":"language/control-flow/#continue","title":"CONTINUE","text":"<p>Skip to next iteration:</p> <pre><code>FOR i IN 1..10 LOOP\n    IF i % 2 == 0 THEN\n        CONTINUE;  -- Skip even numbers\n    END IF;\n\n    PRINT 'Odd: ' || i;\nEND LOOP;\n</code></pre>"},{"location":"language/control-flow/#nested-loops","title":"Nested Loops","text":"<pre><code>FOR i IN 1..3 LOOP\n    FOR j IN 1..3 LOOP\n        PRINT i || ' x ' || j || ' = ' || (i * j);\n    END LOOP;\nEND LOOP;\n</code></pre>"},{"location":"language/control-flow/#case-expression","title":"CASE Expression","text":"<p>Pattern matching (in expressions):</p> <pre><code>DECLARE status STRING;\nDECLARE severity NUMBER = 5;\n\nSET status = CASE severity\n    WHEN 1 THEN 'Low'\n    WHEN 2 THEN 'Medium'\n    WHEN 3 THEN 'High'\n    ELSE 'Unknown'\nEND;\n</code></pre>"},{"location":"language/control-flow/#early-return","title":"Early Return","text":"<p>Exit procedure early:</p> <pre><code>CREATE PROCEDURE find_user(id NUMBER)\nBEGIN\n    IF id &lt;= 0 THEN\n        RETURN NULL;  -- Early exit\n    END IF;\n\n    -- Continue processing...\n    RETURN user;\nEND PROCEDURE;\n</code></pre>"},{"location":"language/error-handling/","title":"Error Handling","text":""},{"location":"language/error-handling/#try-catch-finally","title":"TRY / CATCH / FINALLY","text":"<p>Handle errors gracefully:</p> <pre><code>TRY\n    -- Code that might fail\n    DECLARE result = risky_operation();\nCATCH\n    -- Handle error\n    PRINT 'An error occurred';\nFINALLY\n    -- Always executed\n    cleanup();\nEND TRY;\n</code></pre>"},{"location":"language/error-handling/#basic-example","title":"Basic Example","text":"<pre><code>CREATE PROCEDURE safe_divide(a NUMBER, b NUMBER)\nBEGIN\n    TRY\n        IF b == 0 THEN\n            THROW 'Division by zero!';\n        END IF;\n        RETURN a / b;\n    CATCH\n        RETURN NULL;\n    END TRY;\nEND PROCEDURE;\n</code></pre>"},{"location":"language/error-handling/#throw","title":"THROW","text":"<p>Raise an error:</p> <pre><code>THROW 'Error message';\n</code></pre> <p>With context:</p> <pre><code>IF user == NULL THEN\n    THROW 'User not found: ' || user_id;\nEND IF;\n</code></pre>"},{"location":"language/error-handling/#catching-specific-errors","title":"Catching Specific Errors","text":"<p>The <code>@error</code> variable contains the error message:</p> <pre><code>TRY\n    -- Code\nCATCH\n    PRINT 'Caught error: ' || @error;\n\n    IF @error LIKE '%timeout%' THEN\n        -- Handle timeout\n    ELSEIF @error LIKE '%not found%' THEN\n        -- Handle not found\n    ELSE\n        -- Re-throw unknown errors\n        THROW @error;\n    END IF;\nEND TRY;\n</code></pre>"},{"location":"language/error-handling/#finally-block","title":"FINALLY Block","text":"<p>Always executed, even if an error occurred:</p> <pre><code>TRY\n    -- Open resources\n    DECLARE conn = open_connection();\n    -- Use connection\nCATCH\n    PRINT 'Error: ' || @error;\nFINALLY\n    -- Always close\n    close_connection(conn);\nEND TRY;\n</code></pre>"},{"location":"language/error-handling/#nested-try-blocks","title":"Nested TRY Blocks","text":"<pre><code>TRY\n    TRY\n        -- Inner operation\n        risky_call();\n    CATCH\n        PRINT 'Inner error handled';\n    END TRY;\n\n    -- Continue outer block\n    another_call();\nCATCH\n    PRINT 'Outer error: ' || @error;\nEND TRY;\n</code></pre>"},{"location":"language/error-handling/#error-propagation","title":"Error Propagation","text":"<p>Errors propagate up if not caught:</p> <pre><code>CREATE PROCEDURE inner_proc()\nBEGIN\n    THROW 'Something went wrong!';\nEND PROCEDURE;\n\nCREATE PROCEDURE outer_proc()\nBEGIN\n    TRY\n        CALL inner_proc();  -- Error propagates here\n    CATCH\n        PRINT 'Caught from inner: ' || @error;\n    END TRY;\nEND PROCEDURE;\n</code></pre>"},{"location":"language/error-handling/#validation-pattern","title":"Validation Pattern","text":"<pre><code>CREATE PROCEDURE validate_order(order DOCUMENT)\nBEGIN\n    IF order.quantity &lt;= 0 THEN\n        THROW 'Quantity must be positive';\n    END IF;\n\n    IF order.price &lt; 0 THEN\n        THROW 'Price cannot be negative';\n    END IF;\n\n    IF order.customer_id == NULL THEN\n        THROW 'Customer ID is required';\n    END IF;\n\n    RETURN TRUE;\nEND PROCEDURE;\n</code></pre>"},{"location":"language/error-handling/#retry-pattern","title":"Retry Pattern","text":"<pre><code>CREATE PROCEDURE with_retry(max_attempts NUMBER)\nBEGIN\n    DECLARE attempt NUMBER = 0;\n\n    WHILE attempt &lt; max_attempts LOOP\n        SET attempt = attempt + 1;\n\n        TRY\n            DECLARE result = call_api();\n            RETURN result;  -- Success, exit\n        CATCH\n            PRINT 'Attempt ' || attempt || ' failed: ' || @error;\n\n            IF attempt &gt;= max_attempts THEN\n                THROW 'Max retries exceeded: ' || @error;\n            END IF;\n\n            -- Wait before retry (if available)\n            -- SLEEP(1000);\n        END TRY;\n    END LOOP;\nEND PROCEDURE;\n</code></pre>"},{"location":"language/error-handling/#best-practices","title":"Best Practices","text":"<p>Be Specific</p> <p>Catch specific error types when possible.</p> <p>Log Errors</p> <p>Always log errors for debugging.</p> <p>Don't Swallow Errors</p> <p>Empty CATCH blocks hide problems.</p> <pre><code>-- \u274c Bad: swallowing errors\nTRY\n    risky_call();\nCATCH\n    -- Silent failure\nEND TRY;\n\n-- \u2705 Good: handle or log\nTRY\n    risky_call();\nCATCH\n    PRINT 'Error in risky_call: ' || @error;\n    -- Take appropriate action\nEND TRY;\n</code></pre>"},{"location":"language/overview/","title":"Language Overview","text":"<p>elastic-script is a procedural scripting language designed to run inside Elasticsearch. It combines familiar SQL-like syntax with modern programming constructs.</p>"},{"location":"language/overview/#key-concepts","title":"Key Concepts","text":""},{"location":"language/overview/#procedures","title":"Procedures","text":"<p>Everything in elastic-script is organized into procedures:</p> <pre><code>CREATE PROCEDURE my_procedure(param1 STRING, param2 NUMBER)\nBEGIN\n    -- Your code here\n    RETURN result;\nEND PROCEDURE;\n</code></pre> <p>Procedures are: - Stored in the <code>.elastic_script_procedures</code> index - Called with <code>CALL procedure_name(args)</code> - Persistent across Elasticsearch restarts</p>"},{"location":"language/overview/#statements","title":"Statements","text":"<p>Procedures contain statements:</p> Statement Purpose <code>DECLARE</code> Create variables <code>SET</code> Assign values <code>PRINT</code> Output to logs <code>IF/THEN/ELSE</code> Conditionals <code>FOR/WHILE</code> Loops <code>TRY/CATCH</code> Error handling <code>RETURN</code> Return value <code>THROW</code> Raise errors"},{"location":"language/overview/#expressions","title":"Expressions","text":"<p>Expressions evaluate to values:</p> <pre><code>-- Arithmetic\nSET x = 10 + 5 * 2;\n\n-- String concatenation\nSET message = 'Hello, ' || name || '!';\n\n-- Comparison\nIF x &gt; 10 THEN ...\n\n-- Function calls\nSET len = LENGTH(message);\n</code></pre>"},{"location":"language/overview/#data-types","title":"Data Types","text":"Type Description Example <code>STRING</code> Text <code>'Hello'</code> or <code>\"World\"</code> <code>NUMBER</code> Numeric <code>42</code>, <code>3.14</code>, <code>-5</code> <code>BOOLEAN</code> True/False <code>TRUE</code>, <code>FALSE</code> <code>DATE</code> Date/timestamp <code>CURRENT_DATE()</code> <code>ARRAY</code> List <code>[1, 2, 3]</code>, <code>['a', 'b']</code> <code>DOCUMENT</code> JSON object <code>{\"key\": \"value\"}</code> <code>CURSOR</code> Query result iterator <code>CURSOR FOR FROM ...</code>"},{"location":"language/overview/#operators","title":"Operators","text":""},{"location":"language/overview/#arithmetic","title":"Arithmetic","text":"<pre><code>+   -- Addition\n-   -- Subtraction\n*   -- Multiplication\n/   -- Division\n%   -- Modulo\n</code></pre>"},{"location":"language/overview/#comparison","title":"Comparison","text":"<pre><code>==  -- Equal\n&lt;&gt;  -- Not equal\n!=  -- Not equal (alias)\n&lt;   -- Less than\n&gt;   -- Greater than\n&lt;=  -- Less than or equal\n&gt;=  -- Greater than or equal\n</code></pre>"},{"location":"language/overview/#logical","title":"Logical","text":"<pre><code>AND -- Logical AND\nOR  -- Logical OR\nNOT -- Logical NOT\n</code></pre>"},{"location":"language/overview/#string","title":"String","text":"<pre><code>||  -- Concatenation\n</code></pre>"},{"location":"language/overview/#special","title":"Special","text":"<pre><code>??  -- Null coalescing\n?.  -- Safe navigation\n..  -- Range (for loops)\n</code></pre>"},{"location":"language/overview/#comments","title":"Comments","text":"<pre><code>-- Single line comment\n\n/* Multi-line\n   comment */\n</code></pre>"},{"location":"language/overview/#api-endpoints","title":"API Endpoints","text":"<p>elastic-script exposes REST endpoints:</p> Endpoint Method Purpose <code>/_escript</code> POST Execute queries <code>/_escript/procedures/{id}</code> GET Get procedure <code>/_escript/procedures/{id}</code> DELETE Delete procedure <code>/_escript/procedures/{id}/_call</code> POST Call with params"},{"location":"language/overview/#query-structure","title":"Query Structure","text":"<p>All queries go through <code>POST /_escript</code>:</p> <pre><code>curl -u user:pass http://localhost:9200/_escript \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"query\": \"YOUR QUERY HERE\"}'\n</code></pre> <p>Valid top-level queries: - <code>CREATE PROCEDURE ...</code> - <code>DELETE PROCEDURE ...</code> - <code>CALL procedure_name(...)</code> - <code>DEFINE INTENT ...</code></p>"},{"location":"language/overview/#next-steps","title":"Next Steps","text":"<ul> <li>Variables &amp; Types</li> <li>Control Flow</li> <li>Procedures</li> <li>Async Execution</li> </ul>"},{"location":"language/procedures/","title":"Procedures","text":"<p>Procedures are the fundamental building blocks of elastic-script.</p>"},{"location":"language/procedures/#creating-procedures","title":"Creating Procedures","text":"<pre><code>CREATE PROCEDURE procedure_name(parameters)\nBEGIN\n    -- statements\nEND PROCEDURE;\n</code></pre>"},{"location":"language/procedures/#example","title":"Example","text":"<pre><code>CREATE PROCEDURE greet(name STRING)\nBEGIN\n    RETURN 'Hello, ' || name || '!';\nEND PROCEDURE;\n</code></pre>"},{"location":"language/procedures/#parameters","title":"Parameters","text":""},{"location":"language/procedures/#parameter-modes","title":"Parameter Modes","text":"Mode Description <code>IN</code> Input only (default) <code>OUT</code> Output only <code>INOUT</code> Both input and output <pre><code>CREATE PROCEDURE calculate(IN x NUMBER, IN y NUMBER, OUT result NUMBER)\nBEGIN\n    SET result = x + y;\nEND PROCEDURE;\n</code></pre>"},{"location":"language/procedures/#parameter-types","title":"Parameter Types","text":"<pre><code>CREATE PROCEDURE example(\n    name STRING,\n    count NUMBER,\n    is_active BOOLEAN,\n    items ARRAY,\n    config DOCUMENT\n)\nBEGIN\n    -- Use parameters\nEND PROCEDURE;\n</code></pre>"},{"location":"language/procedures/#default-values","title":"Default Values","text":"<pre><code>CREATE PROCEDURE greet(name STRING DEFAULT 'World')\nBEGIN\n    RETURN 'Hello, ' || name || '!';\nEND PROCEDURE;\n</code></pre>"},{"location":"language/procedures/#calling-procedures","title":"Calling Procedures","text":"<pre><code>CALL procedure_name(arguments)\n</code></pre>"},{"location":"language/procedures/#examples","title":"Examples","text":"<pre><code>-- Simple call\nCALL greet('Alice')\n\n-- With multiple arguments\nCALL calculate(10, 20)\n\n-- With named arguments (future)\nCALL send_email(to: 'user@example.com', subject: 'Hello')\n</code></pre>"},{"location":"language/procedures/#return-values","title":"Return Values","text":""},{"location":"language/procedures/#single-value","title":"Single Value","text":"<pre><code>CREATE PROCEDURE add(a NUMBER, b NUMBER)\nBEGIN\n    RETURN a + b;\nEND PROCEDURE;\n</code></pre>"},{"location":"language/procedures/#document-object","title":"Document (Object)","text":"<pre><code>CREATE PROCEDURE get_stats()\nBEGIN\n    RETURN {\n        \"count\": 42,\n        \"average\": 3.14,\n        \"status\": \"ok\"\n    };\nEND PROCEDURE;\n</code></pre>"},{"location":"language/procedures/#array","title":"Array","text":"<pre><code>CREATE PROCEDURE get_items()\nBEGIN\n    RETURN ['apple', 'banana', 'cherry'];\nEND PROCEDURE;\n</code></pre>"},{"location":"language/procedures/#no-return","title":"No Return","text":"<p>Procedures without <code>RETURN</code> return <code>NULL</code>:</p> <pre><code>CREATE PROCEDURE log_event(message STRING)\nBEGIN\n    PRINT message;\n    INDEX_DOCUMENT('audit-log', {\"message\": message});\nEND PROCEDURE;\n</code></pre>"},{"location":"language/procedures/#deleting-procedures","title":"Deleting Procedures","text":"<pre><code>DELETE PROCEDURE procedure_name;\n</code></pre>"},{"location":"language/procedures/#listing-procedures","title":"Listing Procedures","text":"<pre><code>-- Get all procedures\nDECLARE procs ARRAY = ESCRIPT_PROCEDURES();\n\n-- Get specific procedure\nDECLARE proc DOCUMENT = ESCRIPT_PROCEDURE('greet');\n</code></pre>"},{"location":"language/procedures/#stored-procedures","title":"Stored Procedures","text":"<p>Procedures are stored in <code>.elastic_script_procedures</code>:</p> <pre><code>{\n  \"_id\": \"greet\",\n  \"_source\": {\n    \"id\": \"greet\",\n    \"body\": \"CREATE PROCEDURE greet(name STRING) BEGIN RETURN 'Hello, ' || name || '!'; END PROCEDURE;\",\n    \"created_at\": \"2026-01-09T10:00:00Z\"\n  }\n}\n</code></pre>"},{"location":"language/procedures/#calling-other-procedures","title":"Calling Other Procedures","text":"<p>Procedures can call other procedures:</p> <pre><code>CREATE PROCEDURE helper()\nBEGIN\n    RETURN 'I helped!';\nEND PROCEDURE;\n\nCREATE PROCEDURE main()\nBEGIN\n    DECLARE result STRING = CALL helper();\n    PRINT 'Helper said: ' || result;\n    RETURN result;\nEND PROCEDURE;\n</code></pre>"},{"location":"language/procedures/#best-practices","title":"Best Practices","text":"<p>Single Responsibility</p> <p>Each procedure should do one thing well.</p> <p>Meaningful Names</p> <p>Use descriptive names: <code>calculate_order_total</code> not <code>proc1</code>.</p> <p>Document Parameters</p> <p>Use comments to explain what each parameter does.</p> <pre><code>CREATE PROCEDURE process_order(\n    order_id STRING,     -- Unique order identifier\n    apply_discount BOOLEAN DEFAULT FALSE  -- Apply loyalty discount\n)\nBEGIN\n    -- Implementation\nEND PROCEDURE;\n</code></pre>"},{"location":"language/variables-types/","title":"Variables &amp; Types","text":""},{"location":"language/variables-types/#declaring-variables","title":"Declaring Variables","text":"<p>Use <code>DECLARE</code> to create variables:</p> <pre><code>DECLARE name STRING = 'Alice';\nDECLARE count NUMBER = 42;\nDECLARE is_active BOOLEAN = TRUE;\n</code></pre> <p>Or use <code>VAR</code> for shorthand:</p> <pre><code>VAR name = 'Alice';  -- Type inferred as STRING\n</code></pre>"},{"location":"language/variables-types/#data-types","title":"Data Types","text":""},{"location":"language/variables-types/#string","title":"STRING","text":"<p>Text values with single or double quotes:</p> <pre><code>DECLARE message STRING = 'Hello, World!';\nDECLARE alt STRING = \"Also valid\";\n</code></pre> <p>Operations: <pre><code>-- Concatenation\nSET full_name = first_name || ' ' || last_name;\n\n-- Length\nSET len = LENGTH(message);\n\n-- Substring\nSET part = SUBSTR(message, 1, 5);  -- 'Hello'\n</code></pre></p>"},{"location":"language/variables-types/#number","title":"NUMBER","text":"<p>Integer and floating-point values:</p> <pre><code>DECLARE count NUMBER = 42;\nDECLARE price NUMBER = 19.99;\nDECLARE negative NUMBER = -5;\n</code></pre> <p>Operations: <pre><code>SET total = price * quantity;\nSET average = total / count;\nSET remainder = count % 10;\n</code></pre></p>"},{"location":"language/variables-types/#boolean","title":"BOOLEAN","text":"<p>True or false values (case-insensitive):</p> <pre><code>DECLARE is_active BOOLEAN = TRUE;\nDECLARE is_deleted BOOLEAN = false;\nDECLARE flag BOOLEAN = True;\n</code></pre> <p>Operations: <pre><code>IF is_active AND NOT is_deleted THEN\n    PRINT 'Active record';\nEND IF;\n</code></pre></p>"},{"location":"language/variables-types/#array","title":"ARRAY","text":"<p>Ordered list of values:</p> <pre><code>DECLARE numbers ARRAY = [1, 2, 3, 4, 5];\nDECLARE fruits ARRAY = ['apple', 'banana', 'cherry'];\nDECLARE mixed ARRAY = [1, 'two', TRUE];\n</code></pre> <p>Access: <pre><code>SET first = numbers[0];    -- 1\nSET last = numbers[4];     -- 5\n</code></pre></p> <p>Operations: <pre><code>SET len = ARRAY_LENGTH(fruits);            -- 3\nSET extended = ARRAY_APPEND(fruits, 'date');\nSET found = ARRAY_CONTAINS(fruits, 'apple');  -- TRUE\n</code></pre></p>"},{"location":"language/variables-types/#document","title":"DOCUMENT","text":"<p>JSON objects:</p> <pre><code>DECLARE user DOCUMENT = {\n    \"name\": \"John\",\n    \"age\": 30,\n    \"email\": \"john@example.com\"\n};\n</code></pre> <p>Access: <pre><code>SET name = user.name;           -- Dot notation\nSET age = DOCUMENT_GET(user, 'age');\n</code></pre></p> <p>Operations: <pre><code>SET keys = DOCUMENT_KEYS(user);      -- ['name', 'age', 'email']\nSET values = DOCUMENT_VALUES(user);   -- ['John', 30, 'john@...']\nSET has_name = DOCUMENT_CONTAINS(user, 'name');  -- TRUE\n</code></pre></p>"},{"location":"language/variables-types/#date","title":"DATE","text":"<p>Date and timestamp values:</p> <pre><code>DECLARE today DATE = CURRENT_DATE();\nDECLARE now DATE = CURRENT_TIMESTAMP();\n</code></pre> <p>Operations: <pre><code>SET tomorrow = DATE_ADD(today, 1, 'DAY');\nSET year = EXTRACT_YEAR(today);\nSET month = EXTRACT_MONTH(today);\n</code></pre></p>"},{"location":"language/variables-types/#cursor","title":"CURSOR","text":"<p>Iterator for query results:</p> <pre><code>DECLARE logs CURSOR FOR\n    FROM logs-sample\n    | WHERE level == \"ERROR\"\n    | LIMIT 100;\n\nFOR log IN logs LOOP\n    PRINT log.message;\nEND LOOP;\n</code></pre>"},{"location":"language/variables-types/#assigning-values","title":"Assigning Values","text":"<p>Use <code>SET</code> to assign values:</p> <pre><code>DECLARE x NUMBER = 0;\nSET x = 10;\nSET x = x + 5;\n</code></pre>"},{"location":"language/variables-types/#constants","title":"Constants","text":"<p>Use <code>CONST</code> for immutable values:</p> <pre><code>CONST MAX_RETRIES = 3;\nCONST API_URL = 'https://api.example.com';\n</code></pre>"},{"location":"language/variables-types/#type-conversion","title":"Type Conversion","text":"<p>Implicit conversion happens in many cases:</p> <pre><code>DECLARE num NUMBER = 42;\nPRINT 'Value: ' || num;  -- NUMBER converted to STRING\n</code></pre>"},{"location":"language/variables-types/#null-handling","title":"Null Handling","text":"<pre><code>DECLARE maybe_null STRING;  -- NULL by default\n\n-- Null coalescing\nSET value = maybe_null ?? 'default';\n\n-- Safe navigation\nSET name = user?.profile?.name;\n</code></pre>"},{"location":"language/variables-types/#scope","title":"Scope","text":"<p>Variables are scoped to their procedure:</p> <pre><code>CREATE PROCEDURE outer()\nBEGIN\n    DECLARE x NUMBER = 10;\n\n    -- x is visible here\n    CALL inner();  -- inner() cannot see x\n\n    RETURN x;\nEND PROCEDURE;\n</code></pre>"}]}